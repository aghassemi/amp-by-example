<!--
  ## Introduction

  [amp-position-observer](https://www.ampproject.org/docs/reference/components/amp-position-observer) is a
  functional component that monitors the position of an element within the viewport as a user scrolls,
  and dispatches `enter`, `exit` and `scroll:<Position In Viewport As a Percentage>` events.

  These events in return can be used to `play`, `pause` or `seek` animations
  defined by [amp-animation](https://www.ampproject.org/docs/reference/components/amp-animation) or
  videos to create scrollbound and visibility-based behavior.

  The `amp-position-observer` component is only useful when used with other components
  and does not do anything on its own.
-->

<!--
  ## Use Cases

  [amp-position-observer](https://www.ampproject.org/docs/reference/components/amp-position-observer)
  combined with [amp-animation](https://www.ampproject.org/docs/reference/components/amp-animation) becomes
  a powerful low-level building-block that can handle various uses-cases such as **scrollbound animations**,
  **parallax effects** and **transitions** as elements enter and exit the viewport such as images
  fade-in and fade-out.

  In this tutorial, we will go through some of these use-cases.
-->

<!-- -->
<!doctype html>
<html âš¡>
<head>
  <meta charset="utf-8">
  <script async src="https://cdn.ampproject.org/v0.js"></script>
  <!-- ## Setup -->
  <!--  Import the amp-position-observer component in the header. -->
  <script async custom-element="amp-position-observer" src="https://cdn.ampproject.org/v0/amp-position-observer-0.1.js"></script>

  <!--  Import the amp-animation component as well to be compibed with amp-position-observer for this tutorial-->
  <script async custom-element="amp-animation" src="https://cdn.ampproject.org/v0/amp-animation-0.1.js"></script>

  <script async custom-element="amp-fit-text" src="https://cdn.ampproject.org/v0/amp-fit-text-0.1.js"></script>

  <script async custom-element="amp-carousel" src="https://cdn.ampproject.org/v0/amp-carousel-0.1.js"></script>


  <link rel="canonical" href="<%host%>/components/amp-position-observer/">
  <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
  <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
<style amp-custom>
  .fidget-spinner-scene {
    margin: 10px 20%;
  }

  .card {
    margin: 10%;
    position: relative;
  }

  .card-title {
    margin: 10px;
    color: #FAFAFA;
    transform: translateX(-100%);
  }

  .card-title h2 {
    margin: 0;
    margin-bottom: 20px;
    font-weight: bold;
    font-family: 'Roboto';
  }

  .parallax-image-window {
    overflow: hidden;
  }

  .parallax-image-window amp-img {
    margin-bottom: -30%;
  }

  .carousel-container {
    margin-right: -300px;
    margin-left: 300px;
  }

</style>
</head>
<body>

<!--
  ## Scrollbound Animations

  For this sample, let's have a fidget spinner that rotates as user scroll the page!

  This sample showcases the core concept behind combinding `amp-position-observer` and
  `amp-animation`: ability to progress through a keyframe animation timeline as an
  element progresses through the viewport.
-->

<!--
  We use `div` and `amp-img` for our scene.
-->
  <div class="fidget-spinner-scene">
      <amp-position-observer
        intersection-ratios="1"
        on="scroll:spinAnimation.seekTo(percent=event.percent)"
        layout="nodisplay">
      </amp-position-observer>
    <amp-img id="fidgetSpinnerImage" width="1024" height="1114" layout="responsive" src="/img/fidget.png" alt="Picture of a fidget spinner"></amp-img>
  </div>
  <!--
   Here we define TODO
  -->
  <amp-animation id="spinAnimation" layout="nodisplay">
      <script type="application/json">
        {
        "duration": "1",
        "fill": "both",
        "direction": "alternate",
        "animations": [
          {
            "selector": "#fidgetSpinnerImage",
            "keyframes": [
              { "transform": "rotate(360deg)" }
            ]
          }
        ]
      }
      </script>
  </amp-animation>

<!--
  ## Transitions

  TODO
-->
<!--
  We use `div` and `amp-img` for our scene.
-->
  <div class="card ampstart-card">
    <amp-position-observer
      intersection-ratios="0"
      on="scroll:fadeTransition.seekTo(percent=event.percent)"
      layout="nodisplay">
    </amp-position-observer>

    <amp-position-observer
      intersection-ratios="0.8"
      on="enter:slideTransition.start;exit:slideOutTransition.start"
      layout="nodisplay">
    </amp-position-observer>

    <amp-fit-text layout="fill">
      <div class="card-title">
        <h2>Organic, fresh </br> tomatos and pasta.</h2>
        <h3>Learn More</h3>
      </div>
    </amp-fit-text>
    <amp-img id="cardImage" width="1280" height="898" layout="responsive" src="/img/food.jpg" alt="Picture of food table."></amp-img>
  </div>
<!--
Here we define TODO
-->
  <amp-animation id="fadeTransition" layout="nodisplay">
    <script type="application/json">
      {
        "duration": "1s",
        "fill": "both",
        "iterations": "1",
        "animations": [
          {
            "selector": "#cardImage",
            "keyframes": [
              { "opacity": "0.3", "offset": 0 },
              { "opacity": "1", "offset": 0.4 },
              { "opacity": "1", "offset": 0.6 },
              { "opacity": "0.3", "offset": 1 }
            ]
          }
        ]
      }
    </script>
  </amp-animation>
  <!--
Here we define TODO
-->
  <amp-animation id="slideTransition" layout="nodisplay">
      <script type="application/json">
        {
          "duration": "500ms",
          "fill": "both",
          "easing": "ease-out",
          "iterations": "1",
          "animations": [
            {
              "selector": ".card-title",
              "keyframes": [
                { "transform": "translateX(0)" }
              ]
            }
          ]
        }
      </script>
  </amp-animation>

    <!--
Here we define TODO
-->
<amp-animation id="slideOutTransition" layout="nodisplay">
    <script type="application/json">
      {
        "duration": "500ms",
        "fill": "both",
        "easing": "ease-in",
        "iterations": "1",
        "animations": [
          {
            "selector": ".card-title",
            "keyframes": [
              { "transform": "translateX(-100%)" }
            ]
          }
        ]
      }
    </script>
</amp-animation>

<!--
## Parallax Image Window
-->
<div class="parallax-image-window">
    <amp-position-observer
    intersection-ratios="1"
    on="scroll:parallaxTransition.seekTo(percent=event.percent)"
    layout="nodisplay">
  </amp-position-observer>
   <amp-img id="parallaxImage" width="1280" height="873" layout="responsive" src="/img/elephant.jpg" alt="Picture of food table."></amp-img>
</div>

    <!--
Here we define TODO
-->
<amp-animation id="parallaxTransition" layout="nodisplay">
    <script type="application/json">
      {
        "duration": "1",
        "fill": "both",
        "iterations": "1",
        "animations": [
          {
            "selector": "#parallaxImage",
            "keyframes": [
              { "transform": "translateY(-30%)" }
            ]
          }
        ]
      }
    </script>
</amp-animation>

<!--
## Carousel Transition
-->
<amp-carousel class="carousel-container" height="300" layout="fixed-height" type="carousel">
    <amp-position-observer
    intersection-ratios="0.8"
    on="enter:carouselTrasnsition.start"
    layout="nodisplay">
  </amp-position-observer>
    <amp-img src="https://unsplash.it/800/600?image=1003" width="400" height="300" alt="a sample image"></amp-img>
    <amp-img src="https://unsplash.it/800/600?image=1043" width="400" height="300" alt="another sample image"></amp-img>
    <amp-img src="https://unsplash.it/800/600?image=1032" width="400" height="300" alt="and another sample image"></amp-img>
</amp-carousel>
</div>
    <!--
Here we define TODO
-->
<amp-animation id="carouselTrasnsition" layout="nodisplay">
    <script type="application/json">
      {
        "duration": "500ms",
        "fill": "both",
        "iterations": "1",
        "easing": "ease-in",
        "delay": "200ms",
        "animations": [
          {
            "selector": ".carousel-container",
            "keyframes": [
              { "transform": "translateX(-300px)" }
            ]
          }
        ]
      }
    </script>
</amp-animation>

</body>
</html>
